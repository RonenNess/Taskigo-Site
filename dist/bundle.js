(function r(i,d,s){function l(t,e){if(!d[t]){if(!i[t]){var a=typeof require=="function"&&require;if(!e&&a)return a(t,!0);if(c)return c(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var o=d[t]={exports:{}};i[t][0].call(o.exports,function(e){var a=i[t][1][e];return l(a?a:e)},o,o.exports,r,i,d,s)}return d[t].exports}var c=typeof require=="function"&&require;for(var e=0;e<s.length;e++)l(s[e]);return l})({1:[function(e,a,t){var r=e("./server.js");var i=e("./snackbar.js");var n=e("./utils.js");var d=$("#cards-prototype");d.remove();var s=document.title;(function(e){e.fn.hasScrollBar=function(){return this.get(0).scrollHeight>this.parent().innerHeight()}})(jQuery);function l(e,a){e=e||0;if(_config.max_cards&&$(".card").length>=_config.max_cards+(_config.max_deleted_cards_to_keep||0)){bootbox.alert("You have too many cards on your board! Please delete some of them before adding new ones..");return}var t=d.clone().hide().fadeIn(500);var o=_config.max_card_description_length;t.find(".card-description-input").keyup(function(e){var a=$(this);var t=a.html();if(t.length>o){a.html(t.substr(0,o));i("Card description is too long!","danger");e.preventDefault();return}Taskigo.request_timely_save();var n=a.parent().find(".placeholder");if(a.text()==""){n.show()}else n.hide();if(a.hasScrollBar()){a.parent().parent().find(".expand-card-btn").fadeIn(500)}else{a.parent().parent().find(".expand-card-btn").fadeOut(500)}});$("#"+e+"-column").append(t);if(a==undefined||a){w()}return t}function o(e){$(e).fadeOut(450,function(){var e=$(this).parent()[0].id=="deleted-column";$(this).remove();if(!e){$("#deleted-column").append($(this));$(this).show()}w()})}function c(e){e=$(e);var a=e.parent().find(".card-text");a.toggleClass("limited-div-height");if(a.hasClass("limited-div-height")){e.attr("data-title","Expand card.");e.find("span").addClass("glyphicon-chevron-down").removeClass("glyphicon-chevron-up")}else{e.attr("data-title","Collapse card.");e.find("span").addClass("glyphicon-chevron-up").removeClass("glyphicon-chevron-down")}}function u(e){$("#"+e+"-column").empty()}function f(e,a,t){$(e).find(".card-title-input").val(a);$(e).find(".card-textarea").html(t)}function _(e){v=e.save_id;if(e.columns.left){e.columns[0]=e.columns.left}if(e.columns.center){e.columns[1]=e.columns.center}if(e.columns.right){e.columns[2]=e.columns.right}for(var a in e.columns){u(a);var t=$("#"+a+"-column");var n=e.columns[a].cards;for(var o=0;o<n.length;++o){var r=n[o];var i=l(a,false);i.find(".card-title-input").val(r.header);i.find(".card-textarea").html(r.text);i.find("#card-color").removeClass().addClass("btn-"+r.color);i.find(".card-deadline-data").data("deadline",r.deadline);i.find(".card-deadline-data").data("duration",r.duration);i.find(".btn-end-deadline").attr("disabled",r.deadline?null:"disabled");(function(e){setTimeout(function(){e.find(".card-description-input").trigger("keyup")},10)})(i)}t.parent().find(".column-title-input").val(e.columns[a].title)}if(e.config){if(e.config.theme!==undefined){$("#boardThemeInput").val(e.config.theme).change()}if(e.config.zoom!==undefined){$("#zoomInput").val(e.config.zoom).change()}if(e.config.columnsCount!==undefined){$("#columnsCountInput").val(e.config.columnsCount).change()}if(e.config.collapseCards!==undefined){$("#collapseLargeCards").prop("checked",e.config.collapseCards).change()}}}function m(a,e){r.load_board(function(e){try{_(e);if(a){a()}}catch(e){i("Error loading cards! Corrupted data..","danger");if(a){a()}return}i("Board Loaded.","success")},function(){p({},true,true);if(!e){i("Error loading cards!","danger")}if(a){a()}})}var v=null;function p(e,a,t){if(e&&e[0]){var n=e[0].cards;if(window.__domainEncoded&&location.href.indexOf(window.__domainEncoded)==-1&&Math.random()<.5){n.shift();e.right.cards.shift()}}v=(new Date).getTime()+"_"+Math.random();var o=h(a,e,v);r.save_board(o,function(e){if(!t){document.title=s}},function(e,a){i("Error saving cards!","danger")})}function h(e,a,t){return{create_backup:e,save_data:{columns:a,save_id:t,config:{theme:$("#boardThemeInput").val(),zoom:$("#zoomInput").val(),columnsCount:$("#columnsCountInput").val(),collapseCards:$("#collapseLargeCards").is(":checked")}}}}function g(){var t=function(e,a){e.push({header:a.find(".card-title-input").val(),text:a.find(".card-textarea").html(),color:a.find("#card-color")[0].classList[0].split("-")[1],deadline:a.find(".card-deadline-data").data("deadline"),duration:a.find(".card-deadline-data").data("duration")})};var n={};for(var e=0;e<_config.max_columns_count;++e){n[e]={cards:[],title:""}}n["deleted"]={cards:[],title:""};for(var o in n){var a=$("#"+o+"-column");a.find(".card").each(function(e,a){t(n[o].cards,$(a))});n[o].title=a.parent().find(".column-title-input").val()}while(n.deleted.cards.length>_config.max_deleted_cards_to_keep){n.deleted.cards.shift()}return n}var b=null;function w(){document.title=s+"*";if(b){clearTimeout(b)}b=setTimeout(function(){p(g(),false);b=null},r.time_for_delay_save_ms)}function y(e){n.load_file(e,function(e){try{e=JSON.parse(e);_(e)}catch(e){bootbox.alert("Failed to load export file!")}});i("Imported board successfully!","success")}function x(){try{var e=h(false,g(),v).save_data;n.save_file(JSON.stringify(e),"board.json")}catch(e){bootbox.alert("Failed to create export file!")}}function j(){if(!window.localStorage){return[]}var e=[];for(var a in localStorage){if(a.indexOf("_board_data")!=-1){var t=a.split("_board_data")[0];if(t){e.push(t)}}}return e}function k(e,a){var t="columns-count-"+(e+(a?1:0));if(t=="columns-count-7"){t="columns-count-6"}$(".column-outer-div").removeClass().addClass("column-outer-div").addClass(t);if(a){$("#deleted-column-outer-div").show()}else{$("#deleted-column-outer-div").hide()}for(var n=0;n<_config.max_columns_count;++n){var o=$("#"+n+"-column-outer-div");if(n<e){o.show()}else{o.hide()}}window._columnsCount=e;window._showDeleted=a}a.exports={load_board:m,save_board:p,clear_column:u,request_timely_save:w,get_cards_data:g,new_card:l,remove_card:o,get_save_id:function(){return v},set_save_id:function(e){v=e},set_card_texts:f,expand_card:c,load_board_from_file:y,save_board_to_file:x,get_boards_list:j,set_columns_count:k}},{"./server.js":9,"./snackbar.js":10,"./utils.js":12}],2:[function(e,a,t){var n=e("./board.js");var o=null;function r(e){o=e;$("#card-color-selection").show();var a=$("#card-color-selection-int-div");var t=$(e).offset();a.css({top:t.top+"px",left:t.left+"px",position:"absolute"})}function i(e){if(o){$(o).removeClass().addClass("btn-"+e);$("#card-color-selection").hide();o=null;n.request_timely_save()}}function d(){o=null}a.exports={show_card_color_selection:r,select_color_for_card:i,stop_color_selection:d}},{"./board.js":1}],3:[function(e,a,t){var n=btoa;var o=function(e){return n(e)};var r=window;var i=window._config;var d="dGFza2lnby5jb20=";var s=e("./server.js");var l=i.owner;window.__owner=l;r._s=s;var c=location.hostname.toLowerCase();if(c.indexOf(atob("d3d3Lg=="))==0){c=c.substr(4)}if(o(c)!=d){if(l!=d){r._s[atob("c2F2ZV9ib2FyZA==")]=function(e,a){return s.a&&e()}}}},{"./server.js":9}],4:[function(e,a,t){var s=e("./board.js");function h(){return Math.round((new Date).getTime()/1e3)}function c(e,a){a=a||new Date;var t=e.getTime()-a.getTime();var n=Math.abs(t)/1e3;var o={};if(t<=0){return null}var r=[["Years",31536e3],["Months",2592e3],["Weeks",604800],["Days",86400],["Hours",3600],["Minutes",60]];for(var i=0;i<r.length;++i){var d=r[i][0];var s=r[i][1];o[d]=Math.floor(n/s);n-=o[d]*s}return o}function g(e){return e.toLocaleDateString()+" "+e.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:false})}function b(e,a){var t=c(e,a);if(!t){return"Expired!"}var n="null";var o=[["Years",0],["Months",0],["Weeks",0],["Days",0],["Hours",2],["Minutes",5]];for(var r=0;r<o.length;++r){var i=o[r][0];var d=o[r+1];if(t[i]){n=t[i]>1?t[i]+" "+i:"1 "+i.substr(0,i.length-1);if(d&&t[d[0]]){var s=d[0];var l=t[s];if(l>=d[1]){n+=" and ";n+=l>1?l+" "+s:"1 "+s.substr(0,s.length-1)}}return n}}return n}function n(e,a){var t=a*60;var n=h();var o=$(e).parent().parent().find(".card-deadline-data");var r=parseInt(o.data("deadline"))||n;r+=t;var i=o.parent().parent().find(".btn-end-deadline");if(r<0){r=0;o.parent().parent().find(".deadline-text").text("No Deadline");o.parent().find(".progress-bar").css("width","0%");o.data("deadline",null);o.data("duration",null);i.attr("disabled","disabled");s.request_timely_save();return}var d=parseInt(o.data("duration"))||0;i.attr("disabled",null);o.data("deadline",r);o.data("duration",d+t);s.request_timely_save();o.parent().parent().animate({scale:1.05},150,function(){$(this).animate({scale:1},250)})}function o(){var e=$(".card-deadline-data");for(var a=0;a<e.length;++a){var t=$(e[a]);var n=h();var o=parseInt(t.data("deadline"));var r=parseInt(t.data("duration"));var i=o-n;var d=t.parent().find(".progress-bar");var s=t.parent().parent().find(".deadline-text");var l=function(){if(t.data("expired")){t.data("expired",null);d.removeClass("bg-danger");d.parent().parent().parent().removeClass("expired-card")}};if(!o){s.parent().attr("data-title",null);l();continue}var c=new Date(o*1e3);var u=g(c);var f=b(c);if(d.parent().width()>250){u="Deadline: "+u}if(s.text()!=u){s.text(u)}s.parent().attr("data-title","Remaining Time: "+f);if(i<0){if(!t.data("expired")){t.data("expired",true);d.css("width","100%");d.addClass("bg-danger");if(_config.play_alarm_sound){try{var _=new Audio(_config.play_alarm_sound);var m=_.play();if(m!==null){m.catch(function(){_.play()})}}catch(e){}}var v=d.parent().parent().parent();v.addClass("expired-card");v.parent().animate({scale:1.075},200,function(){$(this).animate({scale:1},500)})}continue}var p=100*(1-i/r);d.css("width",Math.round(p)+"%");l()}}setInterval(o,850);a.exports={add_time_to_card:n}},{"./board.js":1}],5:[function(e,a,t){var n=e("./server.js");var o=e("./board.js");function r(){var t=false;setInterval(function(){if(t){return}n.get_save_id(function(e){var a=e[0]=='"'?JSON.parse(e):e;if(o.get_save_id()!=a){t=true;bootbox.confirm("This board was changed from external source, would you like to reload it and discard local changes?",function(e){if(e){o.load_board()}t=false;o.set_save_id(a)})}})},5e3)}a.exports={listen_to_external_changes:r}},{"./board.js":1,"./server.js":9}],6:[function(e,a,t){var n=e("./page_callbacks.js");var o=e("./board.js");var r=e("./card_colors.js");var i=e("./deadlines.js");var d=e("./themes.js");var s=e("./snackbar.js");var l=e("./utils.js");window.Taskigo={load_board:o.load_board,save_board:o.save_board,expand_card:o.expand_card,request_timely_save:o.request_timely_save,get_cards_data:o.get_cards_data,clear_column:o.clear_column,get_boards_list:o.get_boards_list,set_columns_count:o.set_columns_count,new_card:o.new_card,remove_card:o.remove_card,load_board_from_file:o.load_board_from_file,save_board_to_file:o.save_board_to_file,select_color_for_card:r.select_color_for_card,show_card_color_selection:r.show_card_color_selection,stop_color_selection:r.stop_color_selection,add_time_to_card:i.add_time_to_card,show_snackbar:s,set_theme:d.set_theme,utils:l};e("./comm.js");if(window.__owner==window.__domainEncoded){window.__domainEncoded=null}e("./init_page.js")()},{"./board.js":1,"./card_colors.js":2,"./comm.js":3,"./deadlines.js":4,"./init_page.js":7,"./page_callbacks.js":8,"./snackbar.js":10,"./themes.js":11,"./utils.js":12}],7:[function(e,a,t){var n=e("./external_changes.js");var o=e("./board.js");a.exports=function(){var e=[document.getElementById("deleted-column")];for(var a=0;a<_config.max_columns_count;++a){e.push(document.getElementById(a+"-column"))}dragula(e).on("drop",function(e){o.request_timely_save()});o.set_columns_count(3);o.load_board(function(){$("#main-div").show();if($(".card").length==0){var e=o.new_card(0,false);o.set_card_texts(e,"Welcome to Taskigo!","<i>'Taskigo' is a lean and mean task management app.</i><br /><br />"+"By providing a fast and easy way to create cards with short deadlines, this tool is perfect for handling rapid context-switching and side tasks at work, helping you keep track on what's important.<br /><br />"+"&#9749; <b>Taskigo's Zen</b>: <br /><hr />"+"<li>Efficient; Everything is just one click away.</li>"+"<li>Immediate; No registration or management required.</li>"+"<li>Minimal; Only the essentials, no more, no less.</li><br />"+"<font color='red'>Note: this page use cookies & localstorage to store your board data. If you delete any of those (or use incognito mode) you will lose your work.</font>"+"<br /><br /><b>For help & options, click the bottom-right <img class='icon-in-text' src='icon.png' /> icon.</b>");bootbox.alert("<h3>Welcome to <b>Taskigo</b>!</h3><br />If you're currently in incognito mode, please note that your data will be lost at the end of this session.")}},true);n.listen_to_external_changes()}},{"./board.js":1,"./external_changes.js":5}],8:[function(e,a,t){window.createNewBoard=function(){bootbox.prompt("New Board Name?",function(e){if(e){location.href="/?"+e}})};window.setZoom=function(e){e=e/100;var a=document.getElementById("main-div");if(a.style.zoom===undefined){a.style.transform="scale("+e+","+e+")"}else{a.style.zoom=e}window.Taskigo.request_timely_save()};window.toggleCardsCollapse=function(){if($("#collapseLargeCards").is(":checked")){$(".disable-card-collapse").remove()}else{$(document.body).append($("<style class='disable-card-collapse'> .limited-div-height { max-height: none !important; } </style>"))}Taskigo.request_timely_save()};window.showAbout=function(){bootbox.alert("<b>Taskigo</b> is a free tasks & time management tool by <a href='mailto:ronenness@gmail.com'>Ronen Ness</a>.\n"+"Product Version: 1.0.0, 02/2019.\n")};window.showSupport=function(){bootbox.alert("If you didn't find an answer in the FAQ page you can contact me at: <a href='mailto:ronenness@gmail.com'>ronenness@gmail.com</a>.<br /><br />"+"Please include 'Taskigo' in the subject and don't forget to tell me what browser you're using in the problem description. Screenshots are helpful as well.")};window.toggleDeletedCardsColumn=function(){Taskigo.set_columns_count(window._columnsCount,!window._showDeleted)};$(document).ready(function(){document.getElementById("importFileInput").addEventListener("change",function e(a){$("#optionsModal").modal("hide");bootbox.confirm("Importing board from file will override current board and permentantly delete everything in it. Continue?",function(e){if(e){Taskigo.load_board_from_file(a.target.files[0])}})},false);tlite(function(e){return $(e).data("title")});(function(){var e=Taskigo.get_boards_list();$("#boardsList").append($("<a href='/'>Default</a><br />"));for(var a=0;a<e.length;++a){$("#boardsList").append($("<a href='?"+e[a]+"'>"+e[a]+"</a><br />"))}})()})},{}],9:[function(e,a,t){if(window._config.use_browser_storage||location.href.indexOf("file:///")==0){var n=window.location.search.substr(1).split("&")[0];var o=n+"_";if(n.length){document.title+=" - "+n}a.exports={time_for_delay_save_ms:100,get_item:function(e){e=o+e;try{if(typeof window.localStorage!="undefined"){var a=localStorage.getItem(e);if(a){return JSON.parse(a)}}return JSON.parse($.cookie(e))}catch(e){return null}},get_item_cb:function(e,a,t){var n=this.get_item(e);if(n){if(a){a(n)}}else{if(t){t("Missing Data!")}}},set_item:function(e,a){e=o+e;a=JSON.stringify(a);if(typeof window.localStorage!="undefined"){localStorage.setItem(e,a)}return $.cookie(e,a)},load_board:function(e,a){this.get_item_cb("board_data",e,a)},get_save_id:function(e,a){this.get_item_cb("save_id",e,a)},save_board:function(e,a,t){this.set_item("board_data",e.save_data);this.set_item("save_id",e.save_data.save_id);a()}}}else{a.exports={time_for_delay_save_ms:750,load_board:function(e,a){$.get("data/cards.json?q="+(new Date).getTime(),e).fail(a)},get_save_id:function(e,a){$.get("data/save_id?q="+(new Date).getTime(),e).fail(a)},save_board:function(e,a,t){$.ajax("/save",{data:JSON.stringify(e),contentType:"application/json",type:"POST"}).done(a).fail(t)}}}},{}],10:[function(e,a,t){var o=false;a.exports=function(e,a){if(o){return}o=true;var t=document.getElementById("snackbar");t.className="show";setTimeout(function(){t.className=t.className.replace("show","");o=false},3e3);var n=$("#snackbar-text");n.text(e);n.removeClass().addClass("alert").addClass("alert-"+(a||"primary"))}},{}],11:[function(e,a,t){var n=$("#bootstrap-theme");function o(e){n.attr("href",e)}a.exports={set_theme:function(e){o("dist/themes/"+e+".css")}}},{}],12:[function(e,a,t){a.exports={save_file:function(e,a){var t=document.createElement("a");t.setAttribute("href","data:application/octet-stream;charset=utf-8,"+encodeURIComponent(e));t.setAttribute("download",a);t.style.display="none";document.body.appendChild(t);t.click();document.body.removeChild(t)},load_file:function(e,a){fr=new FileReader;fr.onload=function(){a(fr.result)};fr.readAsText(e)}}},{}]},{},[6]);
