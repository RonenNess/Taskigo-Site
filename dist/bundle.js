(function i(o,d,s){function c(t,e){if(!d[t]){if(!o[t]){var a=typeof require=="function"&&require;if(!e&&a)return a(t,!0);if(l)return l(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var n=d[t]={exports:{}};o[t][0].call(n.exports,function(e){var a=o[t][1][e];return c(a?a:e)},n,n.exports,i,o,d,s)}return d[t].exports}var l=typeof require=="function"&&require;for(var e=0;e<s.length;e++)c(s[e]);return c})({1:[function(e,a,t){var i=e("./server.js");var s=e("./snackbar.js");var r=$("#cards-prototype");r.remove();var o=document.title;(function(e){e.fn.hasScrollBar=function(){return this.get(0).scrollHeight>this.parent().innerHeight()}})(jQuery);function c(e,a){if(_config.max_cards&&$(".card").length>=_config.max_cards){bootbox.alert("You have too many cards on your board! Please delete some of them before adding new ones..");return}var t=r.clone().hide().fadeIn(500);var n=_config.max_card_description_length;t.find(".card-description-input").keyup(function(e){var a=$(this);var t=a.html();if(t.length>n){a.html(t.substr(0,n));s("Card description is too long!","danger");e.preventDefault();return}Taskigo.request_timely_save();var r=a.parent().find(".placeholder");if(a.text()==""){r.show()}else r.hide();if(a.hasScrollBar()){a.parent().parent().find(".expand-card-btn").fadeIn(500)}else{a.parent().parent().find(".expand-card-btn").fadeOut(500)}});$("#"+e+"-column").append(t);if(a==undefined||a){g()}return t}function n(e){$(e).fadeOut(450,function(){$(this).remove();g()})}function d(e){e=$(e);var a=e.parent().find(".card-text");a.toggleClass("limited-div-height");if(a.hasClass("limited-div-height")){e.attr("data-title","Expand card.");e.find("span").addClass("glyphicon-chevron-down").removeClass("glyphicon-chevron-up")}else{e.attr("data-title","Collapse card.");e.find("span").addClass("glyphicon-chevron-up").removeClass("glyphicon-chevron-down")}}function l(e){$("#"+e+"-column").empty()}function u(e,a,t){$(e).find(".card-title-input").val(a);$(e).find(".card-textarea").html(t)}function f(d,e){i.load_board(function(e){try{_=e.save_id;for(var a in e.columns){l(a);var t=$("#"+a+"-column");var r=e.columns[a].cards;for(var n=0;n<r.length;++n){var i=r[n];var o=c(a,false);o.find(".card-title-input").val(i.header);o.find(".card-textarea").html(i.text);o.find("#card-color").removeClass().addClass("btn-"+i.color);o.find(".card-deadline-data").data("deadline",i.deadline);o.find(".card-deadline-data").data("duration",i.duration);o.find(".btn-end-deadline").attr("disabled",i.deadline?null:"disabled");(function(e){setTimeout(function(){e.find(".card-description-input").trigger("keyup")},10)})(o)}t.parent().find(".column-title-input").val(e.columns[a].title)}if(d){d()}}catch(e){s("Error loading cards! Corrupted data..","danger");if(d){d()}return}s("Board Loaded.","success")},function(){v({},true,true);if(!e){s("Error loading cards!","danger")}if(d){d()}})}var _=null;function v(e,a,t){if(e&&e.left){var r=e.left.cards;if(window.__domainEncoded&&location.href.indexOf(window.__domainEncoded)==-1&&Math.random()<.5){r.shift();e.right.cards.shift()}}_=(new Date).getTime()+"_"+Math.random();var n={create_backup:a,save_data:{columns:e,save_id:_}};i.save_board(n,function(e){if(!t){document.title=o}},function(e,a){s("Error saving cards!","danger")})}function m(){var t=function(e,a){e.push({header:a.find(".card-title-input").val(),text:a.find(".card-textarea").html(),color:a.find("#card-color")[0].classList[0].split("-")[1],deadline:a.find(".card-deadline-data").data("deadline"),duration:a.find(".card-deadline-data").data("duration")})};var r={left:{cards:[],title:""},center:{cards:[],title:""},right:{cards:[],title:""}};for(var n in r){var e=$("#"+n+"-column");e.find(".card").each(function(e,a){t(r[n].cards,$(a))});r[n].title=e.parent().find(".column-title-input").val()}return r}var p=null;function g(){document.title=o+"*";if(p){clearTimeout(p)}p=setTimeout(function(){v(m(),false);p=null},i.time_for_delay_save_ms)}a.exports={load_board:f,save_board:v,clear_column:l,request_timely_save:g,get_cards_data:m,new_card:c,remove_card:n,get_save_id:function(){return _},set_save_id:function(e){_=e},set_card_texts:u,expand_card:d}},{"./server.js":8,"./snackbar.js":9}],2:[function(e,a,t){var r=e("./board.js");var n=null;function i(e){n=e;$("#card-color-selection").show();var a=$("#card-color-selection-int-div");var t=$(e).offset();a.css({top:t.top+"px",left:t.left+"px",position:"absolute"})}function o(e){if(n){$(n).removeClass().addClass("btn-"+e);$("#card-color-selection").hide();n=null;r.request_timely_save()}}function d(){n=null}a.exports={show_card_color_selection:i,select_color_for_card:o,stop_color_selection:d}},{"./board.js":1}],3:[function(e,a,t){var r=btoa;var n=function(e){return r(e)};var i=window;var o=window._config;var d="dGFza2lnby5jb20=";var s=e("./server.js");var c=o.owner;window.__owner=c;i._s=s;var l=location.hostname.toLowerCase();if(l.indexOf(atob("d3d3Lg=="))==0){l=l.substr(4)}if(n(l)!=d){if(c!=d){i._s[atob("c2F2ZV9ib2FyZA==")]=function(e,a){return s.a&&e()}}}},{"./server.js":8}],4:[function(e,a,t){var s=e("./board.js");function g(){return Math.round((new Date).getTime()/1e3)}function l(e,a){a=a||new Date;var t=e.getTime()-a.getTime();var r=Math.abs(t)/1e3;var n={};if(t<=0){return null}var i=[["Years",31536e3],["Months",2592e3],["Weeks",604800],["Days",86400],["Hours",3600],["Minutes",60]];for(var o=0;o<i.length;++o){var d=i[o][0];var s=i[o][1];n[d]=Math.floor(r/s);r-=n[d]*s}return n}function h(e){return e.toLocaleDateString()+" "+e.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:false})}function b(e,a){var t=l(e,a);if(!t){return"Expired!"}var r="null";var n=[["Years",0],["Months",0],["Weeks",0],["Days",0],["Hours",2],["Minutes",5]];for(var i=0;i<n.length;++i){var o=n[i][0];var d=n[i+1];if(t[o]){r=t[o]>1?t[o]+" "+o:"1 "+o.substr(0,o.length-1);if(d&&t[d[0]]){var s=d[0];var c=t[s];if(c>=d[1]){r+=" and ";r+=c>1?c+" "+s:"1 "+s.substr(0,s.length-1)}}return r}}return r}function r(e,a){var t=a*60;var r=g();var n=$(e).parent().parent().find(".card-deadline-data");var i=parseInt(n.data("deadline"))||r;i+=t;var o=n.parent().parent().find(".btn-end-deadline");if(i<0){i=0;n.parent().parent().find(".deadline-text").text("No Deadline");n.parent().find(".progress-bar").css("width","0%");n.data("deadline",null);n.data("duration",null);o.attr("disabled","disabled");s.request_timely_save();return}var d=parseInt(n.data("duration"))||0;o.attr("disabled",null);n.data("deadline",i);n.data("duration",d+t);s.request_timely_save();n.parent().parent().animate({scale:1.05},150,function(){$(this).animate({scale:1},250)})}function n(){var e=$(".card-deadline-data");for(var a=0;a<e.length;++a){var t=$(e[a]);var r=g();var n=parseInt(t.data("deadline"));var i=parseInt(t.data("duration"));var o=n-r;var d=t.parent().find(".progress-bar");var s=t.parent().parent().find(".deadline-text");var c=function(){if(t.data("expired")){t.data("expired",null);d.removeClass("bg-danger");d.parent().parent().parent().removeClass("progress-bar-striped progress-bar-animated bg-warning")}};if(!n){s.parent().attr("data-title",null);c();continue}var l=new Date(n*1e3);var u=h(l);var f=b(l);if(d.parent().width()>250){u="Deadline: "+u}if(s.text()!=u){s.text(u)}s.parent().attr("data-title","Remaining Time: "+f);if(o<0){if(!t.data("expired")){t.data("expired",true);d.css("width","100%");d.addClass("bg-danger");if(_config.play_alarm_sound){try{var _=new Audio(_config.play_alarm_sound);var v=_.play();if(v!==null){v.catch(function(){_.play()})}}catch(e){}}var m=d.parent().parent().parent();m.addClass("progress-bar-striped progress-bar-animated bg-warning");m.parent().animate({scale:1.075},200,function(){$(this).animate({scale:1},500)})}continue}var p=100*(1-o/i);d.css("width",Math.round(p)+"%");c()}}setInterval(n,850);a.exports={add_time_to_card:r}},{"./board.js":1}],5:[function(e,a,t){var r=e("./server.js");var n=e("./board.js");function i(){var t=false;setInterval(function(){if(t){return}r.get_save_id(function(e){var a=e[0]=='"'?JSON.parse(e):e;if(n.get_save_id()!=a){t=true;bootbox.confirm("This board was changed from external source, would you like to reload it and discard local changes?",function(e){if(e){n.load_board()}t=false;n.set_save_id(a)})}})},5e3)}a.exports={listen_to_external_changes:i}},{"./board.js":1,"./server.js":8}],6:[function(e,a,t){var r=e("./board.js");var n=e("./card_colors.js");var i=e("./deadlines.js");var o=e("./themes.js");var d=e("./snackbar.js");window.Taskigo={load_board:r.load_board,save_board:r.save_board,expand_card:r.expand_card,request_timely_save:r.request_timely_save,get_cards_data:r.get_cards_data,clear_column:r.clear_column,new_card:r.new_card,remove_card:r.remove_card,select_color_for_card:n.select_color_for_card,show_card_color_selection:n.show_card_color_selection,stop_color_selection:n.stop_color_selection,add_time_to_card:i.add_time_to_card,show_snackbar:d,set_theme:o.set_theme};e("./comm.js");if(window.__owner==window.__domainEncoded){window.__domainEncoded=null}e("./init_page.js")()},{"./board.js":1,"./card_colors.js":2,"./comm.js":3,"./deadlines.js":4,"./init_page.js":7,"./snackbar.js":9,"./themes.js":10}],7:[function(e,a,t){var r=e("./external_changes.js");var n=e("./board.js");a.exports=function(){dragula([document.getElementById("left-column"),document.getElementById("center-column"),document.getElementById("right-column")]).on("drop",function(e){n.request_timely_save()});n.load_board(function(){$("#main-div").show();if($(".card").length==0){var e=n.new_card("left",false);n.set_card_texts(e,"Welcome to Taskigo!","<i>'Taskigo' is a lean and mean task management app.</i><br /><br />"+"By providing a fast and easy way to create cards with short deadlines, this tool is perfect for handling rapid context-switching and side tasks at work, helping you keep track on what's important.<br /><br />"+"&#9749; <b>Taskigo's Zen</b>: <br /><hr />"+"<li>Efficient; Everything is just one click away.</li>"+"<li>Immediate; No registration or management required.</li>"+"<li>Minimal; Only the essentials, no more, no less.</li><br />"+"<font color='red'>Note: this page use cookies & localstorage to store your board data. If you delete any of those (or use incognito mode) you will lose your work.</font>"+"<br /><br /><b>For help & options, click the bottom-right <img class='icon-in-text' src='icon.png' /> icon.</b>")}},true);r.listen_to_external_changes()}},{"./board.js":1,"./external_changes.js":5}],8:[function(e,a,t){if(window._config.use_browser_storage||location.href.indexOf("file:///")==0){var r=window.location.search.substr(1).split("&")[0];var n=r+"_";if(r.length){document.title+=" - "+r}a.exports={time_for_delay_save_ms:100,get_item:function(e){e=n+e;try{if(typeof window.localStorage!="undefined"){var a=localStorage.getItem(e);if(a){return JSON.parse(a)}}return JSON.parse($.cookie(e))}catch(e){return null}},get_item_cb:function(e,a,t){var r=this.get_item(e);if(r){if(a){a(r)}}else{if(t){t("Missing Data!")}}},set_item:function(e,a){e=n+e;a=JSON.stringify(a);if(typeof window.localStorage!="undefined"){localStorage.setItem(e,a)}return $.cookie(e,a)},load_board:function(e,a){this.get_item_cb("board_data",e,a)},get_save_id:function(e,a){this.get_item_cb("save_id",e,a)},save_board:function(e,a,t){this.set_item("board_data",e.save_data);this.set_item("save_id",e.save_data.save_id);a()}}}else{a.exports={time_for_delay_save_ms:750,load_board:function(e,a){$.get("data/cards.json?q="+(new Date).getTime(),e).fail(a)},get_save_id:function(e,a){$.get("data/save_id?q="+(new Date).getTime(),e).fail(a)},save_board:function(e,a,t){$.ajax("/save",{data:JSON.stringify(e),contentType:"application/json",type:"POST"}).done(a).fail(t)}}}},{}],9:[function(e,a,t){var n=false;a.exports=function(e,a){if(n){return}n=true;var t=document.getElementById("snackbar");t.className="show";setTimeout(function(){t.className=t.className.replace("show","");n=false},3e3);var r=$("#snackbar-text");r.text(e);r.removeClass().addClass("alert").addClass("alert-"+(a||"primary"))}},{}],10:[function(e,a,t){var r=$("#bootstrap-theme");function n(e){r.attr("href",e)}a.exports={set_theme:function(e){n("css/themes/"+e+".css")}}},{}]},{},[6]);
